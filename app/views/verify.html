<div class="verify">
  <div id="instructions" ng-if="!ready">
    <div class="row">
      <h2>¿Cómo Funciona?</h2>
    </div>
    <div class="row bottom-padder-md">
      <div class="col-md-4 col-md-offset-0 col-sm-10 col-sm-offset-1 col-md-offset-0 col-sm-10 col-sm-offset-1">
        <object data="images/endorse_onboard1.svg" type="image/svg+xml" alt="I'm Yeoman"></object>
        <p>First you will need to upload the root certificates corresponding to your country and type of electronic signature being used (e.g. Mexico - SAT)</p>
      </div>
      <div class="col-md-4 col-md-offset-0 col-sm-10 col-sm-offset-1">
        <object data="images/endorse_onboard2.svg" type="image/svg+xml" alt="I'm Yeoman"></object>
        <p>Next, you need to find the .xml file type sent to you after signing the document, which contains information regarding the document and its signers and will be necessary to verify the information.</p>
      </div>
      <div class="col-md-4 col-md-offset-0 col-sm-10 col-sm-offset-1">
        <object data="images/endorse_onboard3.svg" type="image/svg+xml" alt="I'm Yeoman"></object>
        <p>Finally, once you receive the results of the verification, ensure that all fields have a check mark next to it. If there are any errors, you should review the reason for the error and try again or contact the signers.</p>
      </div>
    </div>
    <div class="row top-padder-md">
      <button class="btn-lg btn-success" ui-sref="config">Get Started</button>
    </div>
  </div>

  <div class="row" ng-show="ready && !pdfUrl">
    <div class="upload text-center" dropzone>
      <div class="upload-default">
        <h5 class="bottom-padder-md">Drag the XML you want to verify.</h5>
        <button class="btn">or click here to select one</button>
        <input accept-name="XML" accept="text/xml" text="true" class="file-upload-input" fileread="upload" required="true" type="file">
      </div>
    </div>
</div>

<div ng-show="pdfUrl">
  <h2>Signatures</h2>

  <div class="row top-padder-md">
    <div class="col-md-3">
      <strong>Document Name</strong>
    </div>
    <div class="col-md-9"> 
      {{ doc.name }}
    </div>
  </div>

  <div class="row">
    <div class="col-md-3" ng-class="{'text-success': oHashValid, 'text-danger': !oHashValid}">
      <strong>Original Hash <i class="glyphicon" ng-class="{'glyphicon-ok': oHashValid, 'glyphicon-remove': !oHashValid}"></i></strong>
    </div>
    <div class="col-md-9"> 
      {{ doc.originalHash }}
      <a href="" ng-show="!oHashValid" ng-click="showOHashError = !showOHashError">Why?</a>
      <div class="alert alert-danger alert-incorrect" ng-show="showOHashError" role="alert">
        The original hash is incorrect
      </div>      
    </div>
  </div>

  <div class="row top-padder-md" id="signers" ng-repeat="signature in signatures">
    <div class="col-md-3">
      <strong>Signed By</strong>
    </div>
    <div class="col-md-9"> 
      {{ signature.signer.name }} &lt;{{ signature.signer.email }}&gt;    
    </div>

    <div class="col-md-3">
      <strong>RFC</strong>
    </div>
    <div class="col-md-9"> 
      {{ signature.signer.id }}    
    </div>

    <div class="col-md-3">
      <strong>Date Signed</strong>
    </div>
    <div class="col-md-9"> 
      {{ signature.signedAt }}
    </div>

    <div class="col-md-3" ng-class="{'text-success': signature.certificate.valid, 'text-danger': !signature.certificate.valid}">
      <strong>Certificate Number <i class="glyphicon" ng-class="{'glyphicon-ok': signature.certificate.valid, 'glyphicon-remove': !signature.certificate.valid}"></i></strong>
    </div>
    <div class="col-md-9"> 
      {{ signature.certificate.getSerialNumber() }}
      <a href="" ng-show="!signature.certificate.valid" ng-click="signature.showCertError = !signature.showCertError">Why?</a>
      <div class="alert alert-danger alert-incorrect" ng-show="signature.showCertError" role="alert">
        The <strong>certificate</strong> was not created with any of the <strong>root certificates</strong> that provided in 'Configuration' page.<br>
        Please provide new ones. If you still see this error, it means the certificate was not issued by who says.
      </div>      
    </div>

    <div class="col-md-3" ng-class="{'text-success': signature.valid, 'text-danger': !signature.valid}">
      <strong>Signature <i class="glyphicon" ng-class="{'glyphicon-ok': signature.valid, 'glyphicon-remove': !signature.valid}"></i></strong>
    </div>
    <div class="col-md-9"> 
      {{ signature.sig('base64') }}
      <a href="" ng-show="!signature.valid" ng-click="signature.showValidError = !signature.showValidError">Why?</a>
      <div class="alert alert-danger alert-incorrect" ng-show="signature.showValidError" role="alert">
        The <strong>signature</strong> is not valid.<br>
        The private key of the certificate did not sign this document.
      </div>    
    </div>
  </div>

  <div class="row top-padder-md bototm-padder-md center">
    <p><strong>You can review the document that was signed below</strong></p>
  </div>
  <div>
    <hr>
    <div id="pdf-container" class="center top-padder-md">
      <ng-pdf template-url="views/pdfViewer.html"></ng-pdf>
    </div>
  </div>
</div>